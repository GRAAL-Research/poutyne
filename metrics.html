<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Metrics &mdash; Poutyne 1.9 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Callbacks" href="callbacks.html" />
    <link rel="prev" title="Experiment and ModelBundle" href="experiment.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/poutyne-light.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.9
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="model.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="experiment.html">Experiment and ModelBundle</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Metrics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#batch-metrics">Batch Metrics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#object-oriented-api">Object-Oriented API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Functional</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#epoch-metrics">Epoch Metrics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#interface">Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="#predefined-epoch-metrics">Predefined Epoch Metrics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#torchmetrics">TorchMetrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-multiple-metrics-at-once">Computing Multiple Metrics at Once</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="callbacks.html">Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="layers.html">Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/introduction.html">Introduction to PyTorch and Poutyne</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/tips_and_tricks.html">Tips and Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/sequence_tagging.html">Sequence Tagging With an RNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/policy_interface.html">Interface of <code class="docutils literal notranslate"><span class="pre">policy</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/transfer_learning.html">Transfer learning example</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/image_reconstruction.html">Image Reconstruction Using Poutyne</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/classification_and_regression.html">Gender Classification and Eyes Location Detection: A Two Task Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/semantic_segmentation.html">Semantic segmentation using Poutyne</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Poutyne</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Metrics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/metrics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="metrics">
<h1>Metrics<a class="headerlink" href="#metrics" title="Permalink to this headline"></a></h1>
<p>Poutyne offers three kinds of metrics: batch metrics, epoch metrics and <a class="reference external" href="https://torchmetrics.readthedocs.io/">torch metrics</a>.
The main difference between batch and epoch metrics is that <strong>batch metrics</strong> are computed at each batch and averaged at the end of an epoch whereas <strong>epoch metrics</strong> compute statistics for each batch and compute the metric at the end of the epoch.
<strong>Torch metrics</strong> can be passed either as epoch metrics (only displayed at the end of the epoch) or using the specialized <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch_metrics</span> <span class="pre">argument</span></code></a> (displayed for each batch and at the end of the epoch).</p>
<p>Epoch metrics offer a way to compute metrics that are not decomposable as an average.
For instance, the predefined <a class="reference internal" href="#poutyne.F1" title="poutyne.F1"><code class="xref py py-class docutils literal notranslate"><span class="pre">F1</span></code></a> epoch metric implements the F1 score.
One who knows what an F1-score may know that an average of multiple F1 scores is not the equivalent of the overall F1 score.</p>
<p>Here is an example using the three kinds of metrics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">poutyne</span> <span class="kn">import</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Accuracy</span><span class="p">,</span> <span class="n">F1</span>
<span class="kn">import</span> <span class="nn">torchmetrics</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span>
    <span class="n">network</span><span class="p">,</span>
    <span class="s1">&#39;sgd&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cross_entropy&#39;</span><span class="p">,</span>

    <span class="n">batch_metrics</span><span class="o">=</span><span class="p">[</span><span class="n">Accuracy</span><span class="p">()],</span>
    <span class="c1"># Can also use a string in this case:</span>
    <span class="c1"># batch_metrics=[&#39;accuracy&#39;],</span>

    <span class="n">epoch_metrics</span><span class="o">=</span><span class="p">[</span><span class="n">F1</span><span class="p">(),</span> <span class="n">torchmetrics</span><span class="o">.</span><span class="n">AUROC</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">)],</span>
    <span class="c1"># Can also use a string in the case of F1-score:</span>
    <span class="c1"># epoch_metrics=[&#39;f1&#39;, torchmetrics.AUROC(num_classes=10)],</span>

    <span class="c1"># TorchMetrics can also bu put in the torch_metrics argument</span>
    <span class="c1"># to show the metric for each batch but sometimes this significantly</span>
    <span class="c1"># slow down the computations.</span>
    <span class="n">torch_metrics</span><span class="o">=</span><span class="p">[</span><span class="n">torchmetrics</span><span class="o">.</span><span class="n">AUROC</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">)],</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit_dataset</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">)</span>
</pre></div>
</div>
<section id="batch-metrics">
<span id="id1"></span><h2>Batch Metrics<a class="headerlink" href="#batch-metrics" title="Permalink to this headline"></a></h2>
<p>Batch metrics are computed at each batch and averaged at the end of an epoch.
The interface is the same as PyTorch loss function, that is <code class="docutils literal notranslate"><span class="pre">metric(y_pred,</span> <span class="pre">y_true)</span></code>.
They are passed to <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> and <a class="reference internal" href="experiment.html#poutyne.ModelBundle.from_network" title="poutyne.ModelBundle.from_network"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModelBundle.from_network()</span></code></a> using the <code class="docutils literal notranslate"><span class="pre">batch_metrics</span></code> argument.</p>
<p>In addition to the predefined batch metrics below, all PyTorch loss functions can be used by string name in the <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">batch_metrics</span> <span class="pre">argument</span></code></a> under their <a class="reference external" href="https://pytorch.org/docs/stable/nn.functional.html">functional</a> name.
The key in <a class="reference internal" href="callbacks.html#poutyne.Callback" title="poutyne.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">callback</span> <span class="pre">logs</span></code></a> associated with each of them is the same as its name but without the <code class="docutils literal notranslate"><span class="pre">_loss</span></code> suffix. For example, the loss function <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.functional.mse_loss.html#torch.nn.functional.mse_loss" title="(in PyTorch v1.10.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mse_loss()</span></code></a> can be passed as a batch metric with the name <code class="docutils literal notranslate"><span class="pre">'mse_loss'</span></code> or simply <code class="docutils literal notranslate"><span class="pre">'mse'</span></code> and the keys are going to be <code class="docutils literal notranslate"><span class="pre">'mse'</span></code> and <code class="docutils literal notranslate"><span class="pre">'val_mse'</span></code> for the training and validation MSE, respectively.
Note that you can also pass the PyTorch loss functions as a loss function in <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> in the same way.</p>
<p>Here is an example using batch metrics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">poutyne</span> <span class="kn">import</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Accuracy</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span>
    <span class="n">network</span><span class="p">,</span>
    <span class="s1">&#39;sgd&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cross_entropy&#39;</span><span class="p">,</span>

    <span class="n">batch_metrics</span><span class="o">=</span><span class="p">[</span><span class="n">Accuracy</span><span class="p">()],</span>
    <span class="c1"># Can also use a string in this case:</span>
    <span class="c1"># batch_metrics=[&#39;accuracy&#39;],</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit_dataset</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">)</span>
</pre></div>
</div>
<section id="object-oriented-api">
<span id="object-oriented-batch-metrics"></span><h3>Object-Oriented API<a class="headerlink" href="#object-oriented-api" title="Permalink to this headline"></a></h3>
<p>Below are classes for predefined batch metrics available in Poutyne.</p>
<dl class="py class">
<dt class="sig sig-object py" id="poutyne.Accuracy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">Accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/batch_metrics.html#Accuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.Accuracy" title="Permalink to this definition"></a></dt>
<dd><p>This metric computes the accuracy using a similar interface to
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html#torch.nn.CrossEntropyLoss" title="(in PyTorch v1.10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossEntropyLoss</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ignore_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Specifies a target value that is ignored and does not contribute
to the accuracy. (Default value = -100)</p></li>
<li><p><strong>reduction</strong> (<em>string</em><em>, </em><em>optional</em>) – Specifies the reduction to apply to the output:
<code class="docutils literal notranslate"><span class="pre">'none'</span></code> | <code class="docutils literal notranslate"><span class="pre">'mean'</span></code> | <code class="docutils literal notranslate"><span class="pre">'sum'</span></code>. <code class="docutils literal notranslate"><span class="pre">'none'</span></code>: no reduction will be applied,
<code class="docutils literal notranslate"><span class="pre">'mean'</span></code>: the sum of the output will be divided by the number of
elements in the output, <code class="docutils literal notranslate"><span class="pre">'sum'</span></code>: the output will be summed.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Possible string name in <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">batch_metrics</span> <span class="pre">argument</span></code></a>:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'acc'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'accuracy'</span></code></p></li>
</ul>
</dd>
<dt>Keys in <a class="reference internal" href="callbacks.html#poutyne.Callback" title="poutyne.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">logs</span></code></a> dictionary of callbacks:</dt><dd><ul class="simple">
<li><p>Train: <code class="docutils literal notranslate"><span class="pre">'acc'</span></code></p></li>
<li><p>Validation: <code class="docutils literal notranslate"><span class="pre">'val_acc'</span></code></p></li>
</ul>
</dd>
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input: <span class="math notranslate nohighlight">\((N, C)\)</span> where <cite>C = number of classes</cite>, or
<span class="math notranslate nohighlight">\((N, C, d_1, d_2, ..., d_K)\)</span> with <span class="math notranslate nohighlight">\(K \geq 1\)</span> in the case of
<cite>K</cite>-dimensional accuracy.</p></li>
<li><p>Target: <span class="math notranslate nohighlight">\((N)\)</span> where each value is <span class="math notranslate nohighlight">\(0 \leq \text{targets}[i] \leq C-1\)</span>, or
<span class="math notranslate nohighlight">\((N, d_1, d_2, ..., d_K)\)</span> with <span class="math notranslate nohighlight">\(K \geq 1\)</span> in the case of
K-dimensional accuracy.</p></li>
<li><p>Output: The accuracy.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="poutyne.BinaryAccuracy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">BinaryAccuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/batch_metrics.html#BinaryAccuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.BinaryAccuracy" title="Permalink to this definition"></a></dt>
<dd><p>This metric computes the accuracy using a similar interface to
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.BCEWithLogitsLoss.html#torch.nn.BCEWithLogitsLoss" title="(in PyTorch v1.10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">BCEWithLogitsLoss</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – the threshold for class <span class="math notranslate nohighlight">\(1\)</span>. Default value is <code class="docutils literal notranslate"><span class="pre">0.</span></code>, that is a
probability of <code class="docutils literal notranslate"><span class="pre">sigmoid(0.)</span> <span class="pre">=</span> <span class="pre">0.5</span></code>.</p></li>
<li><p><strong>reduction</strong> (<em>string</em><em>, </em><em>optional</em>) – Specifies the reduction to apply to the output:
<code class="docutils literal notranslate"><span class="pre">'none'</span></code> | <code class="docutils literal notranslate"><span class="pre">'mean'</span></code> | <code class="docutils literal notranslate"><span class="pre">'sum'</span></code>. <code class="docutils literal notranslate"><span class="pre">'none'</span></code>: no reduction will be applied,
<code class="docutils literal notranslate"><span class="pre">'mean'</span></code>: the sum of the output will be divided by the number of
elements in the output, <code class="docutils literal notranslate"><span class="pre">'sum'</span></code>: the output will be summed.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Possible string name in <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">batch_metrics</span> <span class="pre">argument</span></code></a>:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'bin_acc'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'binary_acc'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'binary_accuracy'</span></code></p></li>
</ul>
</dd>
<dt>Keys in <a class="reference internal" href="callbacks.html#poutyne.Callback" title="poutyne.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">logs</span></code></a> dictionary of callbacks:</dt><dd><ul class="simple">
<li><p>Train: <code class="docutils literal notranslate"><span class="pre">'bin_acc'</span></code></p></li>
<li><p>Validation: <code class="docutils literal notranslate"><span class="pre">'val_bin_acc'</span></code></p></li>
</ul>
</dd>
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input: <span class="math notranslate nohighlight">\((N, *)\)</span> where <span class="math notranslate nohighlight">\(*\)</span> means, any number of additional
dimensions</p></li>
<li><p>Target: <span class="math notranslate nohighlight">\((N, *)\)</span>, same shape as the input</p></li>
<li><p>Output: The binary accuracy.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="poutyne.TopKAccuracy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">TopKAccuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/batch_metrics.html#TopKAccuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.TopKAccuracy" title="Permalink to this definition"></a></dt>
<dd><p>This metric computes the top-k accuracy using a similar interface to
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html#torch.nn.CrossEntropyLoss" title="(in PyTorch v1.10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossEntropyLoss</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Specifies the value of <code class="docutils literal notranslate"><span class="pre">k</span></code> in the top-k accuracy.</p></li>
<li><p><strong>ignore_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Specifies a target value that is ignored and does not contribute
to the top-k accuracy. (Default value = -100)</p></li>
<li><p><strong>reduction</strong> (<em>string</em><em>, </em><em>optional</em>) – Specifies the reduction to apply to the output:
<code class="docutils literal notranslate"><span class="pre">'none'</span></code> | <code class="docutils literal notranslate"><span class="pre">'mean'</span></code> | <code class="docutils literal notranslate"><span class="pre">'sum'</span></code>. <code class="docutils literal notranslate"><span class="pre">'none'</span></code>: no reduction will be applied,
<code class="docutils literal notranslate"><span class="pre">'mean'</span></code>: the sum of the output will be divided by the number of
elements in the output, <code class="docutils literal notranslate"><span class="pre">'sum'</span></code>: the output will be summed.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Possible string name in <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">batch_metrics</span> <span class="pre">argument</span></code></a>:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'top{k}'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'top{k}_acc'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'top{k}_accuracy'</span></code></p></li>
</ul>
<p>for <code class="docutils literal notranslate"><span class="pre">{k}</span></code> from 1 to 10, 20, 30, …, 100.</p>
</dd>
<dt>Keys in <a class="reference internal" href="callbacks.html#poutyne.Callback" title="poutyne.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">logs</span></code></a> dictionary of callbacks:</dt><dd><ul class="simple">
<li><p>Train: <code class="docutils literal notranslate"><span class="pre">'top{k}'</span></code></p></li>
<li><p>Validation: <code class="docutils literal notranslate"><span class="pre">'val_top{k}'</span></code></p></li>
</ul>
<p>where <code class="docutils literal notranslate"><span class="pre">{k}</span></code> is replaced by the value of parameter <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
</dd>
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input: <span class="math notranslate nohighlight">\((N, C)\)</span> where <cite>C = number of classes</cite>, or
<span class="math notranslate nohighlight">\((N, C, d_1, d_2, ..., d_K)\)</span> with <span class="math notranslate nohighlight">\(K \geq 1\)</span> in the case of
<cite>K</cite>-dimensional top-k accuracy.</p></li>
<li><p>Target: <span class="math notranslate nohighlight">\((N)\)</span> where each value is <span class="math notranslate nohighlight">\(0 \leq \text{targets}[i] \leq C-1\)</span>, or
<span class="math notranslate nohighlight">\((N, d_1, d_2, ..., d_K)\)</span> with <span class="math notranslate nohighlight">\(K \geq 1\)</span> in the case of
K-dimensional top-k accuracy.</p></li>
<li><p>Output: The top-k accuracy.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="id2">
<h3>Functional<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h3>
<p>Below is the functional version of the classes in the <a class="reference internal" href="#object-oriented-batch-metrics"><span class="std std-ref">Object-Oriented API</span></a> section.</p>
<dl class="py function">
<dt class="sig sig-object py" id="poutyne.acc">
<span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">acc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/batch_metrics.html#acc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.acc" title="Permalink to this definition"></a></dt>
<dd><p>Computes the accuracy.</p>
<p>This is a functional version of <a class="reference internal" href="#poutyne.Accuracy" title="poutyne.Accuracy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Accuracy</span></code></a>.</p>
<p>See <a class="reference internal" href="#poutyne.Accuracy" title="poutyne.Accuracy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Accuracy</span></code></a> for details.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="poutyne.bin_acc">
<span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">bin_acc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/batch_metrics.html#bin_acc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.bin_acc" title="Permalink to this definition"></a></dt>
<dd><p>Computes the binary accuracy.</p>
<p>This is a functional version of <a class="reference internal" href="#poutyne.BinaryAccuracy" title="poutyne.BinaryAccuracy"><code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryAccuracy</span></code></a>.</p>
<p>See <a class="reference internal" href="#poutyne.BinaryAccuracy" title="poutyne.BinaryAccuracy"><code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryAccuracy</span></code></a> for details.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="poutyne.topk">
<span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">topk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/batch_metrics.html#topk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.topk" title="Permalink to this definition"></a></dt>
<dd><p>Computes the top-k accuracy.</p>
<p>This is a functional version of <a class="reference internal" href="#poutyne.TopKAccuracy" title="poutyne.TopKAccuracy"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopKAccuracy</span></code></a>.</p>
<p>See <a class="reference internal" href="#poutyne.TopKAccuracy" title="poutyne.TopKAccuracy"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopKAccuracy</span></code></a> for details.</p>
</dd></dl>

</section>
</section>
<section id="epoch-metrics">
<span id="id3"></span><h2>Epoch Metrics<a class="headerlink" href="#epoch-metrics" title="Permalink to this headline"></a></h2>
<p>Epoch metrics are metrics calculated <strong>only</strong> at the end of every epoch.
They need to be implemented either inheriting the <a class="reference internal" href="#poutyne.EpochMetric" title="poutyne.EpochMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">EpochMetric</span></code></a> interface or using the <a class="reference external" href="https://torchmetrics.readthedocs.io/en/latest/pages/implement.html#torchmetrics.Metric" title="(in PyTorch-Metrics v0.8.0dev)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchmetrics.Metric</span></code></a> interface.
They are passed to <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> and <a class="reference internal" href="experiment.html#poutyne.ModelBundle.from_network" title="poutyne.ModelBundle.from_network"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModelBundle.from_network()</span></code></a> using the <code class="docutils literal notranslate"><span class="pre">epoch_metrics</span></code> argument.
In addition to those available in <a class="reference external" href="https://torchmetrics.readthedocs.io/en/latest/references/modules.html">TorchMetrics</a>, we also provide a few predefined epoch metrics.</p>
<p>Here is an example using epoch metrics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">poutyne</span> <span class="kn">import</span> <span class="n">Model</span><span class="p">,</span> <span class="n">F1</span>
<span class="kn">import</span> <span class="nn">torchmetrics</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span>
    <span class="n">network</span><span class="p">,</span>
    <span class="s1">&#39;sgd&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cross_entropy&#39;</span><span class="p">,</span>

    <span class="n">epoch_metrics</span><span class="o">=</span><span class="p">[</span><span class="n">F1</span><span class="p">(),</span> <span class="n">torchmetrics</span><span class="o">.</span><span class="n">AUROC</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">)],</span>
    <span class="c1"># Can also use a string in the case of F1-score:</span>
    <span class="c1"># epoch_metrics=[&#39;f1&#39;, torchmetrics.AUROC(num_classes=10)],</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit_dataset</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">)</span>
</pre></div>
</div>
<section id="interface">
<h3>Interface<a class="headerlink" href="#interface" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="poutyne.EpochMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">EpochMetric</span></span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/base.html#EpochMetric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.EpochMetric" title="Permalink to this definition"></a></dt>
<dd><p>The abstract class representing a epoch metric which can be accumulated at each batch and calculated at the end
of the epoch.</p>
<dl class="py method">
<dt class="sig sig-object py" id="poutyne.EpochMetric.forward">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/base.html#EpochMetric.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.EpochMetric.forward" title="Permalink to this definition"></a></dt>
<dd><p>To define the behavior of the metric when called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong> – The prediction of the model.</p></li>
<li><p><strong>y_true</strong> – Target to evaluate the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="poutyne.EpochMetric.get_metric">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_metric</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/base.html#EpochMetric.get_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.EpochMetric.get_metric" title="Permalink to this definition"></a></dt>
<dd><p>Compute and return the metric. Should not modify the state of
the epoch metric.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="poutyne.EpochMetric.reset">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/base.html#EpochMetric.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.EpochMetric.reset" title="Permalink to this definition"></a></dt>
<dd><p>The information kept for the computation of the metric is cleaned so
that a new epoch can be done.</p>
</dd></dl>

</dd></dl>

</section>
<section id="predefined-epoch-metrics">
<h3>Predefined Epoch Metrics<a class="headerlink" href="#predefined-epoch-metrics" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="poutyne.FBeta">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">FBeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'macro'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/fscores.html#FBeta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.FBeta" title="Permalink to this definition"></a></dt>
<dd><p>The source code of this class is under the Apache v2 License and was copied from
the AllenNLP project and has been modified.</p>
<p>Compute precision, recall, F-measure and support for each class.</p>
<p>The precision is the ratio <code class="docutils literal notranslate"><span class="pre">tp</span> <span class="pre">/</span> <span class="pre">(tp</span> <span class="pre">+</span> <span class="pre">fp)</span></code> where <code class="docutils literal notranslate"><span class="pre">tp</span></code> is the number of
true positives and <code class="docutils literal notranslate"><span class="pre">fp</span></code> the number of false positives. The precision is
intuitively the ability of the classifier not to label as positive a sample
that is negative.</p>
<p>The recall is the ratio <code class="docutils literal notranslate"><span class="pre">tp</span> <span class="pre">/</span> <span class="pre">(tp</span> <span class="pre">+</span> <span class="pre">fn)</span></code> where <code class="docutils literal notranslate"><span class="pre">tp</span></code> is the number of
true positives and <code class="docutils literal notranslate"><span class="pre">fn</span></code> the number of false negatives. The recall is
intuitively the ability of the classifier to find all the positive samples.</p>
<p>The F-beta score can be interpreted as a weighted harmonic mean of
the precision and recall, where an F-beta score reaches its best
value at 1 and worst score at 0.</p>
<p>If we have precision and recall, the F-beta score is simply:
<code class="docutils literal notranslate"><span class="pre">F-beta</span> <span class="pre">=</span> <span class="pre">(1</span> <span class="pre">+</span> <span class="pre">beta</span> <span class="pre">**</span> <span class="pre">2)</span> <span class="pre">*</span> <span class="pre">precision</span> <span class="pre">*</span> <span class="pre">recall</span> <span class="pre">/</span> <span class="pre">(beta</span> <span class="pre">**</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">precision</span> <span class="pre">+</span> <span class="pre">recall)</span></code></p>
<p>The F-beta score weights recall more than precision by a factor of
<code class="docutils literal notranslate"><span class="pre">beta</span></code>. <code class="docutils literal notranslate"><span class="pre">beta</span> <span class="pre">==</span> <span class="pre">1.0</span></code> means recall and precision are equally important.</p>
<p>The support is the number of occurrences of each class in <code class="docutils literal notranslate"><span class="pre">y_true</span></code>.</p>
<dl>
<dt>Keys in <a class="reference internal" href="callbacks.html#poutyne.Callback" title="poutyne.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">logs</span></code></a> dictionary of callbacks:</dt><dd><ul class="simple">
<li><p>Train: <code class="docutils literal notranslate"><span class="pre">'{metric}_{average}'</span></code></p></li>
<li><p>Validation: <code class="docutils literal notranslate"><span class="pre">'val_{metric}_{average}'</span></code></p></li>
</ul>
<p>where <code class="docutils literal notranslate"><span class="pre">{metric}</span></code> and <code class="docutils literal notranslate"><span class="pre">{average}</span></code> are replaced by the value of their
respective parameters.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em>) – One of {‘fscore’, ‘precision’, ‘recall’}.
Whether to return the F-score, the precision or the recall. When not
provided, all three metrics are returned. (Default value = None)</p></li>
<li><p><strong>average</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em>) – <p>One of {‘micro’ (default), ‘macro’, label_number}
If the argument is of type integer, the score for this class (the label number) is calculated.
Otherwise, this determines the type of averaging performed on the data:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'binary'</span></code>:</dt><dd><p>Calculate metrics with regard to a single class identified by the
<cite>pos_label</cite> argument. This is equivalent to <cite>average=pos_label</cite> except
that the binary mode is enforced, i.e. an exception will be raised if
there are more than two prediction scores.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'micro'</span></code>:</dt><dd><p>Calculate metrics globally by counting the total true positives,
false negatives and false positives.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'macro'</span></code>:</dt><dd><p>Calculate metrics for each label, and find their unweighted mean.
This does not take label imbalance into account.</p>
</dd>
</dl>
<p>(Default value = ‘macro’)</p>
</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – The strength of recall versus precision in the F-score. (Default value = 1.0)</p></li>
<li><p><strong>pos_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The class with respect to which the metric is computed when <code class="docutils literal notranslate"><span class="pre">average</span> <span class="pre">==</span> <span class="pre">'binary'</span></code>. Otherwise, this
argument has no effect. (Default value = 1)</p></li>
<li><p><strong>ignore_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Specifies a target value that is ignored. This also works in combination with
a mask if provided. (Default value = -100)</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Threshold for when there is a single score for each prediction. If a sigmoid output is used,
this should be between 0 and 1. A suggested value would be 0.5. If a logits output is used, the threshold
would be between -inf and inf. The suggested default value is 0 as to give a probability of 0.5 if a sigmoid
output were used. (Default = 0)</p></li>
<li><p><strong>names</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>]</em><em>]</em>) – The names associated to the metrics. It is a string when
a single metric is requested. It is a list of 3 strings if all metrics are requested.
(Default value = None)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="poutyne.FBeta.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><span class="pre">torch.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/fscores.html#FBeta.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.FBeta.forward" title="Permalink to this definition"></a></dt>
<dd><p>Update the confusion matrix for calculating the F-score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><em>torch.Tensor</em></a>) – A tensor of predictions of shape (batch_size, num_classes, …).</p></li>
<li><p><strong>y_true</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><em>torch.Tensor</em></a><em>, </em><em>Tuple</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><em>torch.Tensor</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><em>torch.Tensor</em></a><em>]</em><em>]</em>) – Ground truths. A tensor of the integer class label of shape (batch_size, …). It must
be the same shape as the <code class="docutils literal notranslate"><span class="pre">y_pred</span></code> tensor without the <code class="docutils literal notranslate"><span class="pre">num_classes</span></code> dimension.
It can also be a tuple with two tensors of the same shape, the first being the
ground truths and the second being a mask.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="poutyne.FBeta.get_metric">
<span class="sig-name descname"><span class="pre">get_metric</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/fscores.html#FBeta.get_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.FBeta.get_metric" title="Permalink to this definition"></a></dt>
<dd><p>Returns either a float if a single metric is set in the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> or a list
of floats [f-score, precision, recall] if all metrics are requested.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="poutyne.FBeta.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/fscores.html#FBeta.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.FBeta.reset" title="Permalink to this definition"></a></dt>
<dd><p>The information kept for the computation of the metric is cleaned so
that a new epoch can be done.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="poutyne.F1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">F1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'macro'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/fscores.html#F1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.F1" title="Permalink to this definition"></a></dt>
<dd><p>Alias class for <a class="reference internal" href="#poutyne.FBeta" title="poutyne.FBeta"><code class="xref py py-class docutils literal notranslate"><span class="pre">FBeta</span></code></a> where <code class="docutils literal notranslate"><span class="pre">metric</span> <span class="pre">==</span> <span class="pre">'fscore'</span></code> and <code class="docutils literal notranslate"><span class="pre">beta</span> <span class="pre">==</span> <span class="pre">1</span></code>.</p>
<dl>
<dt>Possible string name in <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">epoch_metrics</span> <span class="pre">argument</span></code></a>:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'f1'</span></code></p></li>
</ul>
</dd>
<dt>Keys in <a class="reference internal" href="callbacks.html#poutyne.Callback" title="poutyne.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">logs</span></code></a> dictionary of callbacks:</dt><dd><ul class="simple">
<li><p>Train: <code class="docutils literal notranslate"><span class="pre">'fscore_{average}'</span></code></p></li>
<li><p>Validation: <code class="docutils literal notranslate"><span class="pre">'val_fscore_{average}'</span></code></p></li>
</ul>
<p>where <code class="docutils literal notranslate"><span class="pre">{average}</span></code> is replaced by the value of the respective parameter.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="poutyne.Precision">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">Precision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'macro'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/fscores.html#Precision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.Precision" title="Permalink to this definition"></a></dt>
<dd><p>Alias class for <a class="reference internal" href="#poutyne.FBeta" title="poutyne.FBeta"><code class="xref py py-class docutils literal notranslate"><span class="pre">FBeta</span></code></a> where <code class="docutils literal notranslate"><span class="pre">metric</span> <span class="pre">==</span> <span class="pre">'precision'</span></code>.</p>
<dl>
<dt>Possible string name in <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">epoch_metrics</span> <span class="pre">argument</span></code></a>:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'precision'</span></code></p></li>
</ul>
</dd>
<dt>Keys in <a class="reference internal" href="callbacks.html#poutyne.Callback" title="poutyne.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">logs</span></code></a> dictionary of callbacks:</dt><dd><ul class="simple">
<li><p>Train: <code class="docutils literal notranslate"><span class="pre">'precision_{average}'</span></code></p></li>
<li><p>Validation: <code class="docutils literal notranslate"><span class="pre">'val_precision_{average}'</span></code></p></li>
</ul>
<p>where <code class="docutils literal notranslate"><span class="pre">{average}</span></code> is replaced by the value of the respective parameter.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="poutyne.Recall">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">Recall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'macro'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/fscores.html#Recall"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.Recall" title="Permalink to this definition"></a></dt>
<dd><p>Alias class for <a class="reference internal" href="#poutyne.FBeta" title="poutyne.FBeta"><code class="xref py py-class docutils literal notranslate"><span class="pre">FBeta</span></code></a> where <code class="docutils literal notranslate"><span class="pre">metric</span> <span class="pre">==</span> <span class="pre">'recall'</span></code>.</p>
<dl>
<dt>Possible string name in <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">epoch_metrics</span> <span class="pre">argument</span></code></a>:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'recall'</span></code></p></li>
</ul>
</dd>
<dt>Keys in <a class="reference internal" href="callbacks.html#poutyne.Callback" title="poutyne.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">logs</span></code></a> dictionary of callbacks:</dt><dd><ul class="simple">
<li><p>Train: <code class="docutils literal notranslate"><span class="pre">'recall_{average}'</span></code></p></li>
<li><p>Validation: <code class="docutils literal notranslate"><span class="pre">'val_recall_{average}'</span></code></p></li>
</ul>
<p>where <code class="docutils literal notranslate"><span class="pre">{average}</span></code> is replaced by the value of the respective parameter.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="poutyne.BinaryF1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">BinaryF1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/fscores.html#BinaryF1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.BinaryF1" title="Permalink to this definition"></a></dt>
<dd><p>Alias class for <a class="reference internal" href="#poutyne.FBeta" title="poutyne.FBeta"><code class="xref py py-class docutils literal notranslate"><span class="pre">FBeta</span></code></a> where <code class="docutils literal notranslate"><span class="pre">metric</span> <span class="pre">==</span> <span class="pre">'fscore'</span></code>, <code class="docutils literal notranslate"><span class="pre">average='binary'</span></code> and <code class="docutils literal notranslate"><span class="pre">beta</span> <span class="pre">==</span> <span class="pre">1</span></code>.</p>
<dl class="simple">
<dt>Possible string name in <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">epoch_metrics</span> <span class="pre">argument</span></code></a>:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'binary_f1'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'bin_f1'</span></code></p></li>
</ul>
</dd>
<dt>Keys in <a class="reference internal" href="callbacks.html#poutyne.Callback" title="poutyne.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">logs</span></code></a> dictionary of callbacks:</dt><dd><ul class="simple">
<li><p>Train: <code class="docutils literal notranslate"><span class="pre">'bin_fscore'</span></code></p></li>
<li><p>Validation: <code class="docutils literal notranslate"><span class="pre">'val_bin_fscore'</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="poutyne.BinaryPrecision">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">BinaryPrecision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/fscores.html#BinaryPrecision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.BinaryPrecision" title="Permalink to this definition"></a></dt>
<dd><p>Alias class for <a class="reference internal" href="#poutyne.FBeta" title="poutyne.FBeta"><code class="xref py py-class docutils literal notranslate"><span class="pre">FBeta</span></code></a> where <code class="docutils literal notranslate"><span class="pre">metric</span> <span class="pre">==</span> <span class="pre">'precision'</span></code> and <code class="docutils literal notranslate"><span class="pre">average='binary'</span></code>.</p>
<dl class="simple">
<dt>Possible string name in <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">epoch_metrics</span> <span class="pre">argument</span></code></a>:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'binary_precision'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'bin_precision'</span></code></p></li>
</ul>
</dd>
<dt>Keys in <a class="reference internal" href="callbacks.html#poutyne.Callback" title="poutyne.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">logs</span></code></a> dictionary of callbacks:</dt><dd><ul class="simple">
<li><p>Train: <code class="docutils literal notranslate"><span class="pre">'bin_precision'</span></code></p></li>
<li><p>Validation: <code class="docutils literal notranslate"><span class="pre">'val_bin_precision'</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="poutyne.BinaryRecall">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">BinaryRecall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/fscores.html#BinaryRecall"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.BinaryRecall" title="Permalink to this definition"></a></dt>
<dd><p>Alias class for <a class="reference internal" href="#poutyne.FBeta" title="poutyne.FBeta"><code class="xref py py-class docutils literal notranslate"><span class="pre">FBeta</span></code></a> where <code class="docutils literal notranslate"><span class="pre">metric</span> <span class="pre">==</span> <span class="pre">'recall'</span></code> and <code class="docutils literal notranslate"><span class="pre">average='binary'</span></code>.</p>
<dl class="simple">
<dt>Possible string name in <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">epoch_metrics</span> <span class="pre">argument</span></code></a>:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'binary_recall'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'bin_recall'</span></code></p></li>
</ul>
</dd>
<dt>Keys in <a class="reference internal" href="callbacks.html#poutyne.Callback" title="poutyne.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">logs</span></code></a> dictionary of callbacks:</dt><dd><ul class="simple">
<li><p>Train: <code class="docutils literal notranslate"><span class="pre">'bin_recall'</span></code></p></li>
<li><p>Validation: <code class="docutils literal notranslate"><span class="pre">'val_bin_recall'</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="poutyne.SKLearnMetrics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">poutyne.</span></span><span class="sig-name descname"><span class="pre">SKLearnMetrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">funcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><span class="pre">Callable</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><span class="pre">Callable</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><span class="pre">dict</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/sklearn_metrics.html#SKLearnMetrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.SKLearnMetrics" title="Permalink to this definition"></a></dt>
<dd><p>Wrap metrics with Scikit-learn-like interface
(<code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_pred,</span> <span class="pre">sample_weight=sample_weight,</span> <span class="pre">**kwargs)</span></code>).
The <code class="docutils literal notranslate"><span class="pre">SKLearnMetrics</span></code> object has to keep in memory the ground truths and
predictions so that in can compute the metric at the end.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">average_precision_score</span>
<span class="kn">from</span> <span class="nn">poutyne</span> <span class="kn">import</span> <span class="n">SKLearnMetrics</span>
<span class="n">my_epoch_metric</span> <span class="o">=</span> <span class="n">SKLearnMetrics</span><span class="p">([</span><span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">average_precision_score</span><span class="p">])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>funcs</strong> (<em>Union</em><em>[</em><em>Callable</em><em>, </em><em>List</em><em>[</em><em>Callable</em><em>]</em><em>]</em>) – A metric or a list of metrics with a
scikit-learn-like interface.</p></li>
<li><p><strong>kwargs</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a><em>, </em><em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a><em>]</em><em>]</em><em>]</em>) – Optional dictionary of list of dictionaries
corresponding to keyword arguments to pass to each corresponding metric.
(Default value = None)</p></li>
<li><p><strong>names</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em><em>]</em><em>]</em>) – Optional string or list of strings corresponding to
the names given to the metrics. By default, the names are the names of the functions.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="poutyne.SKLearnMetrics.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><span class="pre">torch.Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/sklearn_metrics.html#SKLearnMetrics.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.SKLearnMetrics.forward" title="Permalink to this definition"></a></dt>
<dd><p>Accumulate the predictions, ground truths and sample weights if any.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><em>torch.Tensor</em></a>) – A tensor of predictions of the shape expected by
the metric functions passed to the class.</p></li>
<li><p><strong>y_true</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><em>torch.Tensor</em></a><em>, </em><em>Tuple</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><em>torch.Tensor</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.10.0)"><em>torch.Tensor</em></a><em>]</em><em>]</em>) – Ground truths. A tensor of ground truths of the shape expected by
the metric functions passed to the class.
It can also be a tuple with two tensors, the first being the
ground truths and the second corresponding the <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code>
argument passed to the metric functions in Scikit-Learn.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="poutyne.SKLearnMetrics.get_metric">
<span class="sig-name descname"><span class="pre">get_metric</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><span class="pre">Dict</span></a></span></span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/sklearn_metrics.html#SKLearnMetrics.get_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.SKLearnMetrics.get_metric" title="Permalink to this definition"></a></dt>
<dd><p>Returns the metrics as a dictionary with the names as keys.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="poutyne.SKLearnMetrics.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/poutyne/framework/metrics/epoch_metrics/sklearn_metrics.html#SKLearnMetrics.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#poutyne.SKLearnMetrics.reset" title="Permalink to this definition"></a></dt>
<dd><p>The information kept for the computation of the metric is cleaned so
that a new epoch can be done.</p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="torchmetrics">
<h2>TorchMetrics<a class="headerlink" href="#torchmetrics" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://torchmetrics.readthedocs.io/">TorchMetrics</a> is a library implementing a lot of known metrics in PyTorch.
They are passed to <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> and <a class="reference internal" href="experiment.html#poutyne.ModelBundle.from_network" title="poutyne.ModelBundle.from_network"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModelBundle.from_network()</span></code></a> using either the  <code class="docutils literal notranslate"><span class="pre">epoch_metrics</span></code> argument or the <code class="docutils literal notranslate"><span class="pre">torch_metrics</span></code> argument.
When passed as epoch metrics, they are only displayed at the end of the epoch.
When passed using the specialized <code class="docutils literal notranslate"><span class="pre">torch_metrics</span></code> argument, they are displayed for each batch and at the end of the epoch.
See <a class="reference external" href="https://torchmetrics.readthedocs.io/en/latest/references/modules.html">TorchMetrics documentation</a> for available torch metrics.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When using the <code class="docutils literal notranslate"><span class="pre">torch_metrics</span></code> argument, the torch metrics are computed at each batch.
This can significantly slow down the computations depending on the metrics used.
In such cases, we advise using them as epoch metrics instead.</p>
</div>
<p>Here is an example using TorchMetrics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">poutyne</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="kn">import</span> <span class="nn">torchmetrics</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span>
    <span class="n">network</span><span class="p">,</span>
    <span class="s1">&#39;sgd&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cross_entropy&#39;</span><span class="p">,</span>
    <span class="n">torch_metrics</span><span class="o">=</span><span class="p">[</span><span class="n">torchmetrics</span><span class="o">.</span><span class="n">F1</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">)],</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit_dataset</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="computing-multiple-metrics-at-once">
<span id="multiple-metrics-at-once"></span><h2>Computing Multiple Metrics at Once<a class="headerlink" href="#computing-multiple-metrics-at-once" title="Permalink to this headline"></a></h2>
<p>When passing the metrics to <a class="reference internal" href="model.html#poutyne.Model" title="poutyne.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> and <a class="reference internal" href="experiment.html#poutyne.ModelBundle.from_network" title="poutyne.ModelBundle.from_network"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModelBundle.from_network()</span></code></a>, the name of each batch and epoch metric can be change by passing a tuple <code class="docutils literal notranslate"><span class="pre">(name,</span> <span class="pre">metric)</span></code> instead of simply the metric function or object, where <code class="docutils literal notranslate"><span class="pre">name</span></code> is the alternative name of the metric.</p>
<p>Batch and epoch metrics can return multiple metrics (e.g. an epoch metric could return an F1-score with the associated precision and recall).
The metrics can be returned via an iterable (tuple, list, Numpy arrays, tensors, etc.) or via a mapping (e.g. a dict).
However, in this case, the names of the different metric has to be passed in some way.</p>
<p>There are two ways to do so.
The easiest one is to pass the metric as a tuple <code class="docutils literal notranslate"><span class="pre">(names,</span> <span class="pre">metric)</span></code> where <code class="docutils literal notranslate"><span class="pre">names</span></code> is a tuple containing a name for each metric returned.
Another way is to override the attribute <code class="docutils literal notranslate"><span class="pre">__name__</span></code> of the function or object so that it returns a tuple containing a name for all metrics returned.
Note that, when the metric returns a mapping, the names of the different metrics must be keys in the mapping.</p>
<p>Example with batch metrics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example with custom batch metrics</span>
<span class="n">my_custom_metric</span> <span class="o">=</span> <span class="k">lambda</span> <span class="nb">input</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="mf">42.</span>
<span class="n">my_custom_metric2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="nb">input</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">42.</span><span class="p">,</span> <span class="mf">43.</span><span class="p">])</span>
<span class="n">my_custom_metric3</span> <span class="o">=</span> <span class="k">lambda</span> <span class="nb">input</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mf">42.</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">43.</span><span class="p">}</span>
<span class="n">batch_metrics</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;custom_name&#39;</span><span class="p">,</span> <span class="n">my_custom_metric</span><span class="p">),</span>
    <span class="p">((</span><span class="s1">&#39;metric_1&#39;</span><span class="p">,</span> <span class="s1">&#39;metric_2&#39;</span><span class="p">),</span> <span class="n">my_custom_metric2</span><span class="p">),</span>
    <span class="p">((</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="n">my_custom_metric3</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Example with epoch metrics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">poutyne</span> <span class="kn">import</span> <span class="n">EpochMetric</span>

<span class="k">class</span> <span class="nc">CustomEpochMetric</span><span class="p">(</span><span class="n">EpochMetric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">get_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">42.</span><span class="p">,</span> <span class="mf">43.</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">CustomEpochMetric2</span><span class="p">(</span><span class="n">EpochMetric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">get_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mf">42.</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">43.</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>


<span class="k">class</span> <span class="nc">CustomEpochMetric3</span><span class="p">(</span><span class="n">EpochMetric</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">get_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">42.</span><span class="p">,</span> <span class="mf">43.</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="n">epoch_metrics</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">((</span><span class="s1">&#39;metric_1&#39;</span><span class="p">,</span> <span class="s1">&#39;metric_2&#39;</span><span class="p">),</span> <span class="n">CustomEpochMetric</span><span class="p">()),</span>
    <span class="p">((</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="n">CustomEpochMetric2</span><span class="p">()),</span>
    <span class="n">CustomEpochMetric3</span><span class="p">(),</span>  <span class="c1"># No need to pass the names since the class sets the attribute __name__.</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Example with TorchMetrics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torchmetrics</span> <span class="kn">import</span> <span class="n">F1</span><span class="p">,</span> <span class="n">Precision</span><span class="p">,</span> <span class="n">Recall</span><span class="p">,</span> <span class="n">MetricCollection</span>

<span class="n">metric_collection</span> <span class="o">=</span> <span class="n">MetricCollection</span><span class="p">([</span>
    <span class="n">F1</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">),</span>
    <span class="n">Precision</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">),</span>
    <span class="n">Recall</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span>
<span class="p">])</span>

<span class="c1"># The names are the keys returned by MetricCollection.</span>
<span class="n">torch_metrics</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">((</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">,</span> <span class="s1">&#39;Recall&#39;</span><span class="p">),</span> <span class="n">metric_collection</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="experiment.html" class="btn btn-neutral float-left" title="Experiment and ModelBundle" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="callbacks.html" class="btn btn-neutral float-right" title="Callbacks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2022, Frédérik Paradis.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-177874682-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-177874682-1');
</script>


</body>
</html>